(()=>{"use strict";var e,t={m:{},u:e=>"js/"+e+".js"};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var a=r.getElementsByTagName("script");if(a.length)for(var n=a.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=a[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e+"../"})(),t.b=document.baseURI||self.location.href,function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"}(e||(e={}));const r=(()=>{let e=0;return()=>e++})(),a=(new Error("unknown message type"),new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first")),n=new Error("called FFmpeg.terminate()");new Error("failed to import ffmpeg-core.js");class s{#e=null;#t={};#r={};#a=[];#n=[];loaded=!1;#s=()=>{this.#e&&(this.#e.onmessage=t=>{let{data:{id:r,type:a,data:n}}=t;switch(a){case e.LOAD:this.loaded=!0,this.#t[r](n);break;case e.MOUNT:case e.UNMOUNT:case e.EXEC:case e.WRITE_FILE:case e.READ_FILE:case e.DELETE_FILE:case e.RENAME:case e.CREATE_DIR:case e.LIST_DIR:case e.DELETE_DIR:this.#t[r](n);break;case e.LOG:this.#a.forEach((e=>e(n)));break;case e.PROGRESS:this.#n.forEach((e=>e(n)));break;case e.ERROR:this.#r[r](n)}delete this.#t[r],delete this.#r[r]})};#i=(()=>{var e=this;return function(t){let{type:n,data:s}=t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2?arguments[2]:void 0;return e.#e?new Promise(((t,a)=>{const l=r();e.#e&&e.#e.postMessage({id:l,type:n,data:s},i),e.#t[l]=t,e.#r[l]=a,o?.addEventListener("abort",(()=>{a(new DOMException(`Message # ${l} was aborted`,"AbortError"))}),{once:!0})})):Promise.reject(a)}})();on(e,t){"log"===e?this.#a.push(t):"progress"===e&&this.#n.push(t)}off(e,t){"log"===e?this.#a=this.#a.filter((e=>e!==t)):"progress"===e&&(this.#n=this.#n.filter((e=>e!==t)))}load=(()=>{var r=this;return function(){let{classWorkerURL:a,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{signal:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.#e||(r.#e=a?new Worker(new URL(a,"file:///Users/binvini/Desktop/wetube/node_modules/@ffmpeg/ffmpeg/dist/esm/classes.js"),{type:"module"}):new Worker(new URL(t.p+t.u(607),t.b),{type:void 0}),r.#s()),r.#i({type:e.LOAD,data:n},void 0,s)}})();exec=(()=>{var t=this;return function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,{signal:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.#i({type:e.EXEC,data:{args:r,timeout:a}},void 0,n)}})();terminate=()=>{const e=Object.keys(this.#r);for(const t of e)this.#r[t](n),delete this.#r[t],delete this.#t[t];this.#e&&(this.#e.terminate(),this.#e=null,this.loaded=!1)};writeFile=(()=>{var t=this;return function(r,a){let{signal:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=[];return a instanceof Uint8Array&&s.push(a.buffer),t.#i({type:e.WRITE_FILE,data:{path:r,data:a}},s,n)}})();mount=(t,r,a)=>this.#i({type:e.MOUNT,data:{fsType:t,options:r,mountPoint:a}},[]);unmount=t=>this.#i({type:e.UNMOUNT,data:{mountPoint:t}},[]);readFile=(()=>{var t=this;return function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",{signal:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.#i({type:e.READ_FILE,data:{path:r,encoding:a}},void 0,n)}})();deleteFile=(()=>{var t=this;return function(r){let{signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.#i({type:e.DELETE_FILE,data:{path:r}},void 0,a)}})();rename=(()=>{var t=this;return function(r,a){let{signal:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.#i({type:e.RENAME,data:{oldPath:r,newPath:a}},void 0,n)}})();createDir=(()=>{var t=this;return function(r){let{signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.#i({type:e.CREATE_DIR,data:{path:r}},void 0,a)}})();listDir=(()=>{var t=this;return function(r){let{signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.#i({type:e.LIST_DIR,data:{path:r}},void 0,a)}})();deleteDir=(()=>{var t=this;return function(r){let{signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.#i({type:e.DELETE_DIR,data:{path:r}},void 0,a)}})()}new Error("failed to get response body reader"),new Error("failed to complete download");const i=document.getElementById("actionBtn"),o=document.getElementById("preview");let l,c,d;const E="recording.webm",p="output.mp4",h="thumbnail.jpg",u=(e,t)=>{const r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click()},f=async()=>{i.removeEventListener("click",f),i.innerText="Transcoding...",i.disabled=!0;const e="https://unpkg.com/@ffmpeg/core@^0.12.6/dist/umd",t=new s;t.on({log:!0});const r=await fetch(`${e}/ffmpeg-core.js`),a=await fetch(`${e}/ffmpeg-core.wasm`),n=new Blob([await r.text()],{type:"text/javascript"}),o=new Blob([await a.arrayBuffer()],{type:"application/wasm"}),l=URL.createObjectURL(n),c=URL.createObjectURL(o);await t.load({coreURL:l,wasmURL:c}),await t.writeFile(E,await(async e=>{let t;if("string"==typeof e)t=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map((e=>e.charCodeAt(0))):await(await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await(await fetch(e)).arrayBuffer();else{if(!(e instanceof File||e instanceof Blob))return new Uint8Array;t=await(r=e,new Promise(((e,t)=>{const a=new FileReader;a.onload=()=>{const{result:t}=a;t instanceof ArrayBuffer?e(new Uint8Array(t)):e(new Uint8Array)},a.onerror=e=>{t(Error(`File could not be read! Code=${e?.target?.error?.code||-1}`))},a.readAsArrayBuffer(r)})))}var r;return new Uint8Array(t)})(d)),await t.exec(["-i",E,"-r","60",p]),await t.exec(["-i",E,"-ss","00:00:01","-frames:v","1",h]);const g=await t.readFile(p),w=t.readFile(h),R=new Blob([g.buffer],{type:"video/mp4"}),m=new Blob([w.buffer],{type:"image/jpg"}),L=URL.createObjectURL(R),b=URL.createObjectURL(m);u(L,"MyRecording.mp4"),u(b,"MyThumbnail.jpg"),t.deleteFile(E),t.deleteFile(p),t.deleteFile(h),URL.revokeObjectURL(L),URL.revokeObjectURL(b),URL.revokeObjectURL(d),i.disabled=!1,i.innerText="Record Again",i.addEventListener("click",v)},g=()=>{i.innerText="Download Recording",i.removeEventListener("click",g),i.addEventListener("click",f),c.stop()},v=()=>{i.innerText="Stop Recording",i.removeEventListener("click",v),i.addEventListener("click",g),c=new MediaRecorder(l,{mimeType:"video/webm"}),c.ondataavailable=e=>{d=URL.createObjectURL(e.data),o.srcObject=null,o.src=d,o.loop=!0,o.play()},c.start()};(async()=>{l=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}),o.srcObject=l,o.play()})(),i.addEventListener("click",v)})();